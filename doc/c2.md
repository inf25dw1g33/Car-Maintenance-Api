# Capítulo 2: Recursos

## Modelo de Dados

A API disponibiliza 5 recursos principais, organizados segundo o seguinte modelo relacional:

```
┌──────────────┐       ┌──────────────┐       ┌──────────────────┐
│   OWNERS     │       │   VEHICLES   │       │  SERVICE_TYPES   │
├──────────────┤       ├──────────────┤       ├──────────────────┤
│ id (PK)      │──1:N──│ id (PK)      │       │ id (PK)          │
│ name         │       │ owner_id(FK) │       │ name             │
│ email        │       │ brand        │       │ description      │
│ phone        │       │ model        │       └──────────────────┘
└──────────────┘       │ license_plate│               │
                       │ year         │               │
                       └──────────────┘               │
                              │                       │
                             1:N                     1:N
                              │                       │
                              ▼                       ▼
                       ┌──────────────────────────────┐
                       │      SERVICE_RECORDS         │
                       ├──────────────────────────────┤
                       │ id (PK)                      │
                       │ vehicle_id (FK)              │
                       │ service_type_id (FK)         │
                       │ service_date                 │
                       │ mileage_km                   │
                       │ cost                         │
                       │ notes                        │
                       └──────────────────────────────┘
                                      │
                                     M:N
                                      │
                       ┌──────────────────────────────┐
                       │  SERVICE_RECORD_MECHANICS    │
                       ├──────────────────────────────┤
                       │ service_record_id (FK)       │
                       │ mechanic_id (FK)             │
                       └──────────────────────────────┘
                                      │
                                     M:N
                                      │
                              ┌───────────────┐
                              │   MECHANICS   │
                              ├───────────────┤
                              │ id (PK)       │
                              │ name          │
                              │ specialization│
                              │ phone         │
                              │ email         │
                              └───────────────┘
```

## Descrição dos Recursos

### 1. Owners (Proprietários)

Representa os clientes da oficina, proprietários de veículos.

| Campo | Tipo | Descrição |
|-------|------|-----------|
| id | INT | Identificador único (auto-incremento) |
| name | VARCHAR(100) | Nome completo do proprietário |
| email | VARCHAR(100) | Email (único) |
| phone | VARCHAR(30) | Número de telefone |

**Endpoints:**
- `GET /api/owners` - Lista todos (com filtro opcional por nome)
- `GET /api/owners/{id}` - Obtém um proprietário
- `POST /api/owners` - Cria um novo proprietário
- `PUT /api/owners/{id}` - Atualiza um proprietário
- `DELETE /api/owners/{id}` - Remove um proprietário

### 2. Vehicles (Veículos)

Representa os veículos registados no sistema, associados a proprietários.

| Campo | Tipo | Descrição |
|-------|------|-----------|
| id | INT | Identificador único |
| owner_id | INT | FK para Owners (relação 1:N) |
| brand | VARCHAR(50) | Marca do veículo |
| model | VARCHAR(50) | Modelo do veículo |
| license_plate | VARCHAR(20) | Matrícula (única) |
| year | INT | Ano de fabrico |

**Endpoints:**
- `GET /api/vehicles` - Lista todos (filtros: brand, owner_id, year)
- `GET /api/vehicles/{id}` - Obtém um veículo
- `POST /api/vehicles` - Regista um novo veículo
- `PUT /api/vehicles/{id}` - Atualiza um veículo
- `DELETE /api/vehicles/{id}` - Remove um veículo

### 3. Service Types (Tipos de Serviço)

Catálogo de serviços disponíveis na oficina.

| Campo | Tipo | Descrição |
|-------|------|-----------|
| id | INT | Identificador único |
| name | VARCHAR(100) | Nome do serviço |
| description | VARCHAR(255) | Descrição do serviço |

**Endpoints:**
- `GET /api/service-types` - Lista todos (com filtro por nome)
- `GET /api/service-types/{id}` - Obtém um tipo de serviço
- `POST /api/service-types` - Cria um novo tipo
- `PUT /api/service-types/{id}` - Atualiza um tipo
- `DELETE /api/service-types/{id}` - Remove um tipo

### 4. Service Records (Registos de Manutenção)

Histórico de manutenções realizadas em veículos.

| Campo | Tipo | Descrição |
|-------|------|-----------|
| id | INT | Identificador único |
| vehicle_id | INT | FK para Vehicles |
| service_type_id | INT | FK para Service Types |
| service_date | DATE | Data do serviço |
| mileage_km | INT | Quilometragem na data do serviço |
| cost | DECIMAL(10,2) | Custo do serviço |
| notes | TEXT | Notas/observações |

**Endpoints:**
- `GET /api/service-records` - Lista todos (filtros: vehicle_id, service_type_id, date_from, date_to)
- `GET /api/service-records/{id}` - Obtém um registo
- `POST /api/service-records` - Cria um novo registo
- `PUT /api/service-records/{id}` - Atualiza um registo
- `DELETE /api/service-records/{id}` - Remove um registo
- `GET /api/service-records/{id}/mechanics` - Lista mecânicos do serviço
- `POST /api/service-records/{id}/mechanics/{mechanicId}` - Atribui mecânico
- `DELETE /api/service-records/{id}/mechanics/{mechanicId}` - Remove mecânico

### 5. Mechanics (Mecânicos)

Profissionais que realizam os serviços.

| Campo | Tipo | Descrição |
|-------|------|-----------|
| id | INT | Identificador único |
| name | VARCHAR(100) | Nome do mecânico |
| specialization | VARCHAR(100) | Área de especialização |
| phone | VARCHAR(30) | Telefone |
| email | VARCHAR(100) | Email (único) |

**Endpoints:**
- `GET /api/mechanics` - Lista todos (filtros: name, specialization)
- `GET /api/mechanics/{id}` - Obtém um mecânico
- `POST /api/mechanics` - Cria um novo mecânico
- `PUT /api/mechanics/{id}` - Atualiza um mecânico
- `DELETE /api/mechanics/{id}` - Remove um mecânico
- `GET /api/mechanics/{id}/service-records` - Lista serviços do mecânico

## Relações

### Relações 1:N (um-para-muitos)

1. **Owners → Vehicles**: Um proprietário pode ter vários veículos
2. **Vehicles → Service Records**: Um veículo pode ter vários registos de manutenção
3. **Service Types → Service Records**: Um tipo de serviço pode aparecer em vários registos

### Relação M:N (muitos-para-muitos)

**Service Records ↔ Mechanics**: Um registo de serviço pode ter vários mecânicos associados, e um mecânico pode trabalhar em vários serviços. Esta relação é implementada através da tabela associativa `service_record_mechanics`.

## Dados de Exemplo

A base de dados é inicializada com pelo menos 30 registos em cada tabela principal:

- 30 Proprietários
- 30 Veículos
- 30 Tipos de Serviço
- 30 Mecânicos
- 35 Registos de Manutenção
- 45 Relações Serviço-Mecânico
